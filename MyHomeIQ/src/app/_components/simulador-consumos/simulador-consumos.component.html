<main class="w-screen">
    <div id="actualizar-datos" class="flex justify-center my-5">
        <button (click)="update_consumos()" class="bg-blue-500 text-white font-bold py-2 px-4 rounded">
            Actualizar datos de consumos
        </button>
    </div>
    <div id="inf-general" class="mx-4 flex justify-start">
        <div class="w-1/3">
            <table class="border-collapse border-spacing-0 bg-white shadow-lg p-4">
                <!-- Cabecera de consumo general -->
                <tr>
                    <th colspan="2" id="cabecera-consumo-general" class="bg-blue-500 py-4 px-6 text-white font-bold text-3xl text-center border-b-2">
                        Consumo General
                    </th>
                </tr>
    
                <!-- Fila de etiqueta de consumo general -->
                <tr>
                    <td colspan="2" id="etiqueta-consumo-general" [ngClass]="getEtiquetaClase(etiquetaGlobal)" class="py-4 px-6 text-5xl font-bold text-center border-b-2">
                        {{ etiquetaGlobal || 'Etiqueta de Consumo' }}
                    </td>
                </tr>
                
                <!-- Sección de consumo general -->
                <tr class="bg-blue-500">
                    <td class="py-2 px-6 text-lg font-medium text-white border-b">Consumo Diario (Kw)</td>
                    <td class="py-2 px-6 text-lg text-white border-b">{{ consumoDiario | number: '1.3-3' }}</td>
                </tr>
                <tr class="bg-blue-500">
                    <td class="py-2 px-6 text-lg font-medium text-white border-b">Consumo Mensual (Kw)</td>
                    <td class="py-2 px-6 text-lg text-white border-b">{{ consumoMensual | number: '1.3-3' }}</td>
                </tr>
                <tr class="bg-blue-500">
                    <td class="py-2 px-6 text-lg font-medium text-white border-b">Consumo Anual (Kw)</td>
                    <td class="py-2 px-6 text-lg text-white border-b">{{ consumoAnual | number: '1.3-3' }}</td>
                </tr>
    
                <!-- Sección de potencia general -->
                <tr class="bg-blue-400">
                    <td class="py-2 px-6 text-lg font-medium text-white border-b">Potencia Diaria (W)</td>
                    <td class="py-2 px-6 text-lg text-white border-b">{{ potenciaDiaria | number: '1.3-3' }}</td>
                </tr>
                <tr class="bg-blue-400">
                    <td class="py-2 px-6 text-lg font-medium text-white border-b">Potencia Mensual (W)</td>
                    <td class="py-2 px-6 text-lg text-white border-b">{{ potenciaMensual | number: '1.3-3' }}</td>
                </tr>
                <tr class="bg-blue-400">
                    <td class="py-2 px-6 text-lg font-medium text-white border-b">Potencia Anual (W)</td>
                    <td class="py-2 px-6 text-lg text-white border-b">{{ potenciaAnual | number: '1.3-3' }}</td>
                </tr>
    
                <!-- Sección de intensidad general -->
                <tr class="bg-blue-300">
                    <td class="py-2 px-6 text-lg font-medium text-gray-900 border-b">Intensidad Diaria (A)</td>
                    <td class="py-2 px-6 text-lg text-gray-900 border-b">{{ intensidadDiaria | number: '1.3-3' }}</td>
                </tr>
                <tr class="bg-blue-300">
                    <td class="py-2 px-6 text-lg font-medium text-gray-900 border-b">Intensidad Mensual (A)</td>
                    <td class="py-2 px-6 text-lg text-gray-900 border-b">{{ intensidadMensual | number: '1.3-3' }}</td>
                </tr>
                <tr class="bg-blue-300">
                    <td class="py-2 px-6 text-lg font-medium text-gray-900">Intensidad Anual (A)</td>
                    <td class="py-2 px-6 text-lg text-gray-900">{{ intensidadAnual | number: '1.3-3' }}</td>
                </tr>
            </table>
        </div>

        <!-- Simulador de consumos -->
    <div id="sim-consumos" class="ml-4 w-full h-auto">
        <div id="cabecera-simulador" class="bg-blue-500 w-full p-4 text-white font-bold text-3xl text-center">
            Simulador de consumos
        </div>
        <div class="flex flex-col items-center mt-4">
        <!-- Lista desplegable -->
            <select [(ngModel)]="dispositivoSeleccionado" class="border border-gray-300 p-2 rounded-md">
                <option *ngFor="let dispositivo of consumoDispositivos" [ngValue]="dispositivo">
                    {{ dispositivo.device }}
                </option>
            </select>

        <!-- Botón -->
            <button (click)="addDispositivo()" 
                    class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">
                Añadir dispositivo
            </button>

             <!-- Tabla de dispositivos añadidos -->
            <table *ngIf="dispositivosSeleccionados.length > 0" class="mt-6 border-collapse border border-gray-300 w-3/4">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="border border-gray-300 px-4 py-2 text-left">Dispositivo</th>
                        <th class="border border-gray-300 px-4 py-2 text-left">Estado</th>
                        <th class="border border-gray-300 px-4 py-2 text-left">Duración (horas/día)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let dispositivo of dispositivosSeleccionados">
                        <td class="border border-gray-300 px-4 py-2">{{ dispositivo.device }}</td>
                    <td class="border border-gray-300 px-4 py-2">
                            <select [(ngModel)]="dispositivo.estado" class="border border-gray-300 p-2 rounded-md">
                                <option *ngFor="let estado of dispositivo.estados">{{ estado }}</option>
                            </select>
                        </td>
                        <td class="border border-gray-300 px-4 py-2">
                            <input type="number" [(ngModel)]="dispositivo.duracion" class="border border-gray-300 p-2 rounded-md w-full" min="0" />
                        </td>
                    </tr>
                </tbody>
            </table>

             <!-- Botones Limpiar y Calcular -->
            <div *ngIf="dispositivosSeleccionados.length > 0" class="mt-4 flex space-x-4">
                <button (click)="limpiarDispositivos()" 
                        class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600">
                    Limpiar dispositivos
                </button>
                <button (click)="calcularConsumosSimulador()" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
                    Calcular consumo
                </button>
            </div>

            <table *ngIf="simuladorConsumoDiario" class="mt-6 border-collapse border border-gray-300 w-3/4">
                <thead>
                    <tr class="bg-green-500">
                        <th colspan="2" class="py-4 px-6 text-white font-bold text-3xl text-center border-b">
                            Resultados del Simulador
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Consumo -->
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Consumo Diario (Kw)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorConsumoDiario | number: '1.3-3' }}</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Consumo Mensual (Kw)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorConsumoMensual | number: '1.3-3' }}</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Consumo Anual (Kw)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorConsumoAnual | number: '1.3-3' }}</td>
                    </tr>
                    
                    <!-- Potencia -->
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Potencia Diaria (W)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorPotenciaDiaria | number: '1.3-3' }}</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Potencia Mensual (W)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorPotenciaMensual | number: '1.3-3' }}</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Potencia Anual (W)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorPotenciaAnual | number: '1.3-3' }}</td>
                    </tr>
            
                    <!-- Intensidad -->
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Intensidad Diaria (A)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorIntensidadDiaria | number: '1.3-3' }}</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Intensidad Mensual (A)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorIntensidadMensual | number: '1.3-3' }}</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 px-4 py-2 font-medium">Intensidad Anual (A)</td>
                        <td class="border border-gray-300 px-4 py-2">{{ simuladorIntensidadAnual | number: '1.3-3' }}</td>
                    </tr>
                </tbody>
            </table>  

        </div>          
        </div>
    </div>
</main>
