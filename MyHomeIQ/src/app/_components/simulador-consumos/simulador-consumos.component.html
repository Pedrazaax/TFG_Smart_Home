<main class="w-screen bg-gray-100 py-8">
    <!-- Botón Actualizar -->
    <div id="actualizar-datos" class="flex justify-center my-5">
        <button (click)="update_consumos()" class="bg-blue-500 text-white font-bold py-2 px-6 rounded shadow-md hover:bg-blue-600">
            Actualizar datos de consumos
        </button>
    </div>

    <div id="inf-general" class="max-w-screen-lg mx-auto px-4 my-8 grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Tabla de Consumo General -->
        <div class="bg-white shadow-md rounded-lg overflow-hidden w-full">
            <table class="w-full text-left">
                <!-- Cabecera -->
                <thead>
                    <tr>
                        <th colspan="2" class="bg-blue-500 py-4 text-white font-bold text-2xl text-center">
                            Consumo General
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Etiqueta -->
                    <tr>
                        <td colspan="2" [ngClass]="getEtiquetaClase(etiquetaGlobal)" class="py-6 text-center text-4xl font-bold border-b">
                            {{ etiquetaGlobal || 'Etiqueta de Consumo' }}
                        </td>
                    </tr>
    
                    <!-- Consumos -->
                    <tr class="bg-blue-100">
                        <td class="py-3 px-4 font-medium">Consumo Diario (Kw)</td>
                        <td class="py-3 px-4 text-right">{{ consumoDiario | number: '1.3-3' }}</td>
                    </tr>
                    <tr class="bg-white">
                        <td class="py-3 px-4 font-medium">Consumo Mensual (Kw)</td>
                        <td class="py-3 px-4 text-right">{{ consumoMensual | number: '1.3-3' }}</td>
                    </tr>
                    <tr class="bg-blue-100">
                        <td class="py-3 px-4 font-medium">Consumo Anual (Kw)</td>
                        <td class="py-3 px-4 text-right">{{ consumoAnual | number: '1.3-3' }}</td>
                    </tr>
    
                    <!-- Potencia -->
                    <tr class="bg-blue-50">
                        <td class="py-3 px-4 font-medium">Potencia Diaria (W)</td>
                        <td class="py-3 px-4 text-right">{{ potenciaDiaria | number: '1.3-3' }}</td>
                    </tr>
                    <tr class="bg-white">
                        <td class="py-3 px-4 font-medium">Potencia Mensual (W)</td>
                        <td class="py-3 px-4 text-right">{{ potenciaMensual | number: '1.3-3' }}</td>
                    </tr>
                    <tr class="bg-blue-50">
                        <td class="py-3 px-4 font-medium">Potencia Anual (W)</td>
                        <td class="py-3 px-4 text-right">{{ potenciaAnual | number: '1.3-3' }}</td>
                    </tr>
    
                    <!-- Intensidad -->
                    <tr class="bg-blue-100">
                        <td class="py-3 px-4 font-medium">Intensidad Diaria (A)</td>
                        <td class="py-3 px-4 text-right">{{ intensidadDiaria | number: '1.3-3' }}</td>
                    </tr>
                    <tr class="bg-white">
                        <td class="py-3 px-4 font-medium">Intensidad Mensual (A)</td>
                        <td class="py-3 px-4 text-right">{{ intensidadMensual | number: '1.3-3' }}</td>
                    </tr>
                    <tr class="bg-blue-100">
                        <td class="py-3 px-4 font-medium">Intensidad Anual (A)</td>
                        <td class="py-3 px-4 text-right">{{ intensidadAnual | number: '1.3-3' }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    
        <!-- Tabla de Seguridad -->
        <div class="bg-white shadow-md rounded-lg overflow-hidden w-full">
            <table class="w-full text-left">
                <!-- Cabecera -->
                <thead>
                    <tr>
                        <th colspan="4" class="bg-red-500 py-4 text-white font-bold text-2xl text-center">
                            Seguridad de la Casa
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Etiqueta -->
                    <tr>
                        <td colspan="4" class="py-6 text-center text-4xl font-bold border-b">
                            {{ etiquetaSeguridad || 'Etiqueta de Seguridad' }}
                        </td>
                    </tr>
    
                    <!-- Vulnerabilidades -->
                    <tr class="bg-gray-100">
                        <th class="py-3 px-4">Categoría</th>
                        <th class="py-3 px-4 text-center">Total</th>
                        <th class="py-3 px-4 text-center">Altas</th>
                        <th class="py-3 px-4 text-center">Medias/Bajas</th>
                    </tr>
                    <tr *ngFor="let item of resumenSeguridad" class="hover:bg-gray-50">
                        <td class="py-3 px-4 w-1/4">{{ item.categoria }}</td>
                        <td class="py-3 px-4 text-center w-1/4">{{ item.totalVulnerabilidades }}</td>
                        <td class="py-3 px-4 text-center w-1/4">{{ item.criticidadAlta }}</td>
                        <td class="py-3 px-4 text-center w-1/4">{{ item.criticidadMedia }}</td>
                    </tr>
                    <tr *ngIf="resumenSeguridad.length === 0">
                        <td colspan="4" class="py-4 text-center text-gray-500">
                            No se encontraron vulnerabilidades para los dispositivos.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4" class="py-4 text-center">
                            <button (click)="getSecurity()" class="bg-blue-500 text-white font-bold py-2 px-6 rounded shadow-md hover:bg-blue-600">
                                Actualizar etiqueta de seguridad
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    
    <!-- Simulador de Consumos -->
    <div class="mt-6 bg-white shadow-md rounded-lg p-6 mx-auto max-w-xl">
        <div class="bg-blue-500 text-white font-bold text-xl text-center py-3 rounded">
            Simulador de Consumos
        </div>
        <div class="mt-6 flex items-center gap-4">
            <select [(ngModel)]="dispositivoSeleccionado" class="flex-grow border border-gray-300 p-2 rounded-md">
                <option *ngFor="let dispositivo of consumoDispositivos" [ngValue]="dispositivo">
                    {{ dispositivo.device }}
                </option>
            </select>
            <button (click)="addDispositivo()" 
                    class="bg-blue-500 text-white py-2 px-6 rounded-md hover:bg-blue-600">
                Añadir
            </button>
        </div>
    
        <!-- Tabla de dispositivos añadidos -->
        <div *ngIf="dispositivosSeleccionados.length > 0" class="mt-6 overflow-x-auto">
            <table *ngIf="dispositivosSeleccionados.length > 0" 
                    class="mt-6 border-collapse border border-gray-300 w-full">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="border border-gray-300 px-4 py-2 text-left">Dispositivo</th>
                        <th class="border border-gray-300 px-4 py-2 text-left">Estado</th>
                        <th class="border border-gray-300 px-4 py-2 text-left">Duración (horas/día)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let dispositivo of dispositivosSeleccionados">
                        <td class="border border-gray-300 px-4 py-2">{{ dispositivo.device }}</td>
                        <td class="border border-gray-300 px-4 py-2">
                            <select [(ngModel)]="dispositivo.estado" class="border border-gray-300 p-2 rounded-md">
                                <option *ngFor="let estado of dispositivo.estados">{{ estado }}</option>
                            </select>
                        </td>
                        <td class="border border-gray-300 px-4 py-2">
                            <input type="number" [(ngModel)]="dispositivo.duracion" 
                                    class="border border-gray-300 p-2 rounded-md w-full" min="0" />
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Botones Limpiar y Calcular -->
        <div *ngIf="dispositivosSeleccionados.length > 0" class="mt-4 flex justify-between">
            <button (click)="limpiarDispositivos()" 
                    class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600">
                Limpiar dispositivos
            </button>
            <button (click)="calcularConsumosSimulador()" 
                    class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
                Calcular consumo
            </button>
        </div>
    </div>
    
</main>
